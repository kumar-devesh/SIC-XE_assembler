0		0		COPY START 0
0		0		FIRST STL RETADR
3		0		    LDB #LENGTH     . ESTABLISH BASE REGISTER
6		0		    BASE LENGTH
.    
6		0		CLOOP +JSUB RDREC   . READ INPUT RECORD
a		0		    LDA LENGTH      . TEST FOR EOF 
d		0		    COMP #0
10		0		    JEQ ENDFIL      . EXIT IF EOF FOUND
13		0		    +JSUB WRREC     . WRITE OUTPUT RECORD
17		0		    J CLOOP         . LOOP
.
1a		0		ENDFIL LDA EOF 
1d		0		    STA BUFFER
20		0		    LDA #3          . INCREMENT BY 3
23		0		    STA LENGTH
26		0		    +JSUB WRREC     . WRITE EOF
2a		0		    J @RETADR       . RETURN TO CALLER (OS)
.
2d		0		EOF BYTE C'EOF'
30		0		RETADR RESW 1
33		0		LENGTH RESW 1
36		0		BUFFER RESB 4096
.
. SUBROUTINE TO READ RECORD INTO BUFFER
.
1036		0		RDREC CLEAR X       . CLEAR LOOP COUNTER
1038		0		    CLEAR A         . CLEAR A, S TO ZERO
103a		0		    CLEAR S
103c		0		    +LDT #4096
.
1040		0		RLOOP TD INPUT      . TEST INPUT DEVICE
1043		0		    JEQ RLOOP
1046		2		    RD INPUT        . READ CHARACTER INTO REGISTER A
1046		0		    COMPR A,S
1048		0		    JEQ EXIT        . EXIT LOOP IF END OF RECORD
104b		0		    STCH BUFFER,X  . STORE CHARACTER IN BUFFER
104e		0		    TIXR T 
1050		0		    JLT RLOOP
1053		0		EXIT STX LENGTH
1056		0		    RSUB
1059		0		INPUT BYTE X'F1'
.
. SUBROUTINE TO WRITE RECORD FROM BUFFER
.
105a		0		WRREC CLEAR X
105c		0		    LDT LENGTH
105f		0		WLOOP TD OUTPUT     . TEST OUTPUT DEVICE
1062		0		    JEQ WLOOP
1065		0		    LDCH BUFFER,X
1068		0		    WD OUTPUT
106b		0		    TIXR T
106d		0		    JLT WLOOP 
1070		0		    RSUB 
.
1073		0		OUTPUT BYTE X'05'
1074		0		    END FIRST
Program Length: 1074
